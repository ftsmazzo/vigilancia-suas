-- Script SQL para criar a tabela raw do Cadastro Único (CADU)
-- Banco: vigilancia
-- Tabela: cadu_raw

-- Remove a tabela se já existir (cuidado em produção!)
DROP TABLE IF EXISTS cadu_raw CASCADE;

-- Cria a tabela raw com todos os campos como TEXT para flexibilidade
CREATE TABLE cadu_raw (
    id SERIAL PRIMARY KEY,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    d_cd_ibge TEXT,
    d_cod_familiar_fam TEXT,
    d_dat_cadastramento_fam TEXT,
    d_dat_atual_fam TEXT,
    d_cod_est_cadastral_fam TEXT,
    d_cod_forma_coleta_fam TEXT,
    d_dta_entrevista_fam TEXT,
    d_nom_localidade_fam TEXT,
    d_nom_tip_logradouro_fam TEXT,
    d_nom_titulo_logradouro_fam TEXT,
    d_nom_logradouro_fam TEXT,
    d_num_logradouro_fam TEXT,
    d_des_complemento_fam TEXT,
    d_des_complemento_adic_fam TEXT,
    d_num_cep_logradouro_fam TEXT,
    d_cod_unidade_territorial_fam TEXT,
    d_nom_unidade_territorial_fam TEXT,
    d_txt_referencia_local_fam TEXT,
    d_nom_entrevistador_fam TEXT,
    d_num_cpf_entrevistador_fam TEXT,
    d_vlr_renda_media_fam TEXT,
    d_fx_rfpc TEXT,
    d_vlr_renda_total_fam TEXT,
    d_marc_pbf TEXT,
    d_qtde_meses_desat_cat TEXT,
    d_cod_local_domic_fam TEXT,
    d_cod_especie_domic_fam TEXT,
    d_qtd_comodos_domic_fam TEXT,
    d_qtd_comodos_dormitorio_fam TEXT,
    d_cod_material_piso_fam TEXT,
    d_cod_material_domic_fam TEXT,
    d_cod_agua_canalizada_fam TEXT,
    d_cod_abaste_agua_domic_fam TEXT,
    d_cod_banheiro_domic_fam TEXT,
    d_cod_escoa_sanitario_domic_fam TEXT,
    d_cod_destino_lixo_domic_fam TEXT,
    d_cod_iluminacao_domic_fam TEXT,
    d_cod_calcamento_domic_fam TEXT,
    d_cod_familia_indigena_fam TEXT,
    d_cod_povo_indigena_fam TEXT,
    d_nom_povo_indigena_fam TEXT,
    d_cod_indigena_reside_fam TEXT,
    d_cod_reserva_indigena_fam TEXT,
    d_nom_reserva_indigena_fam TEXT,
    d_ind_familia_quilombola_fam TEXT,
    d_cod_comunidade_quilombola_fam TEXT,
    d_nom_comunidade_quilombola_fam TEXT,
    d_qtd_pessoas_domic_fam TEXT,
    d_qtd_familias_domic_fam TEXT,
    d_qtd_pessoa_inter_0_17_anos_fam TEXT,
    d_qtd_pessoa_inter_18_64_anos_fam TEXT,
    d_qtd_pessoa_inter_65_anos_fam TEXT,
    d_val_desp_energia_fam TEXT,
    d_val_desp_agua_esgoto_fam TEXT,
    d_val_desp_gas_fam TEXT,
    d_val_desp_alimentacao_fam TEXT,
    d_val_desp_transpor_fam TEXT,
    d_val_desp_aluguel_fam TEXT,
    d_val_desp_medicamentos_fam TEXT,
    d_nom_estab_assist_saude_fam TEXT,
    d_cod_eas_fam TEXT,
    d_nom_centro_assist_fam TEXT,
    d_cod_centro_assist_fam TEXT,
    d_ind_risco_scl_vlco_drts TEXT,
    d_ind_risco_scl_inseg_alim TEXT,
    d_num_ddd_contato_1_fam TEXT,
    d_num_tel_contato_1_fam TEXT,
    d_ic_tipo_contato_1_fam TEXT,
    d_ic_envo_sms_contato_1_fam TEXT,
    d_num_tel_contato_2_fam TEXT,
    d_num_ddd_contato_2_fam TEXT,
    d_ic_tipo_contato_2_fam TEXT,
    d_ic_envo_sms_contato_2_fam TEXT,
    d_cod_cta_energ_unid_consum_fam TEXT,
    d_ind_parc_mds_fam TEXT,
    d_ref_cad TEXT,
    d_ref_pbf TEXT,
    p_cod_familiar_fam TEXT,
    p_cod_est_cadastral_memb TEXT,
    p_ind_trabalho_infantil_pessoa TEXT,
    p_nom_pessoa TEXT,
    p_num_nis_pessoa_atual TEXT,
    p_nom_apelido_pessoa TEXT,
    p_cod_sexo_pessoa TEXT,
    p_dta_nasc_pessoa TEXT,
    p_cod_parentesco_rf_pessoa TEXT,
    p_cod_raca_cor_pessoa TEXT,
    p_nom_completo_mae_pessoa TEXT,
    p_nom_completo_pai_pessoa TEXT,
    p_cod_local_nascimento_pessoa TEXT,
    p_sig_uf_munic_nasc_pessoa TEXT,
    p_nom_ibge_munic_nasc_pessoa TEXT,
    p_cod_ibge_munic_nasc_pessoa TEXT,
    p_nom_pais_origem_pessoa TEXT,
    p_cod_pais_origem_pessoa TEXT,
    p_cod_certidao_registrada_pessoa TEXT,
    p_fx_idade TEXT,
    p_marc_pbf TEXT,
    p_ind_identidade_genero TEXT,
    p_ind_transgenero TEXT,
    p_ind_tipo_identidade_genero TEXT,
    p_cod_certidao_civil_pessoa TEXT,
    p_cod_livro_termo_certid_pessoa TEXT,
    p_cod_folha_termo_certid_pessoa TEXT,
    p_cod_termo_matricula_certid_pessoa TEXT,
    p_nom_munic_certid_pessoa TEXT,
    p_cod_ibge_munic_certid_pessoa TEXT,
    p_cod_cartorio_certid_pessoa TEXT,
    p_num_cpf_pessoa TEXT,
    p_num_identidade_pessoa TEXT,
    p_cod_complemento_pessoa TEXT,
    p_dta_emissao_ident_pessoa TEXT,
    p_sig_uf_ident_pessoa TEXT,
    p_sig_orgao_emissor_pessoa TEXT,
    p_num_cart_trab_prev_soc_pessoa TEXT,
    p_num_serie_trab_prev_soc_pessoa TEXT,
    p_dta_emissao_cart_trab_pessoa TEXT,
    p_sig_uf_cart_trab_pessoa TEXT,
    p_num_titulo_eleitor_pessoa TEXT,
    p_num_zona_tit_eleitor_pessoa TEXT,
    p_num_secao_tit_eleitor_pessoa TEXT,
    p_cod_deficiencia_memb TEXT,
    p_ind_def_cegueira_memb TEXT,
    p_ind_def_baixa_visao_memb TEXT,
    p_ind_def_surdez_profunda_memb TEXT,
    p_ind_def_surdez_leve_memb TEXT,
    p_ind_def_fisica_memb TEXT,
    p_ind_def_mental_memb TEXT,
    p_ind_def_sindrome_down_memb TEXT,
    p_ind_def_transtorno_mental_memb TEXT,
    p_ind_ajuda_nao_memb TEXT,
    p_ind_ajuda_familia_memb TEXT,
    p_ind_ajuda_especializado_memb TEXT,
    p_ind_ajuda_vizinho_memb TEXT,
    p_ind_ajuda_instituicao_memb TEXT,
    p_ind_ajuda_outra_memb TEXT,
    p_cod_sabe_ler_escrever_memb TEXT,
    p_ind_frequenta_escola_memb TEXT,
    p_nom_escola_memb TEXT,
    p_cod_escola_local_memb TEXT,
    p_sig_uf_escola_memb TEXT,
    p_nom_munic_escola_memb TEXT,
    p_cod_ibge_munic_escola_memb TEXT,
    p_cod_censo_inep_memb TEXT,
    p_cod_curso_frequenta_memb TEXT,
    p_cod_ano_serie_frequenta_memb TEXT,
    p_cod_curso_frequentou_pessoa_memb TEXT,
    p_cod_ano_serie_frequentou_memb TEXT,
    p_cod_concluiu_frequentou_memb TEXT,
    p_grau_instrucao TEXT,
    p_cod_trabalhou_memb TEXT,
    p_cod_afastado_trab_memb TEXT,
    p_cod_agricultura_trab_memb TEXT,
    p_cod_principal_trab_memb TEXT,
    p_cod_trabalho_12_meses_memb TEXT,
    p_qtd_meses_12_meses_memb TEXT,
    p_fx_renda_individual_805 TEXT,
    p_fx_renda_individual_808 TEXT,
    p_fx_renda_individual_809_1 TEXT,
    p_fx_renda_individual_809_2 TEXT,
    p_fx_renda_individual_809_3 TEXT,
    p_fx_renda_individual_809_4 TEXT,
    p_fx_renda_individual_809_5 TEXT,
    p_marc_sit_rua TEXT,
    p_ind_dormir_rua_memb TEXT,
    p_qtd_dormir_freq_rua_memb TEXT,
    p_ind_dormir_albergue_memb TEXT,
    p_qtd_dormir_freq_albergue_memb TEXT,
    p_ind_dormir_dom_part_memb TEXT,
    p_qtd_dormir_freq_dom_part_memb TEXT,
    p_ind_outro_memb TEXT,
    p_qtd_freq_outro_memb TEXT,
    p_cod_tempo_rua_memb TEXT,
    p_ind_motivo_perda_memb TEXT,
    p_ind_motivo_ameaca_memb TEXT,
    p_ind_motivo_probs_fam_memb TEXT,
    p_ind_motivo_alcool_memb TEXT,
    p_ind_motivo_desemprego_memb TEXT,
    p_ind_motivo_trabalho_memb TEXT,
    p_ind_motivo_saude_memb TEXT,
    p_ind_motivo_pref_memb TEXT,
    p_ind_motivo_outro_memb TEXT,
    p_ind_motivo_nao_sabe_memb TEXT,
    p_ind_motivo_nao_resp_memb TEXT,
    p_cod_tempo_cidade_memb TEXT,
    p_cod_vive_fam_rua_memb TEXT,
    p_cod_contato_parente_memb TEXT,
    p_ind_ativ_com_escola_memb TEXT,
    p_ind_ativ_com_coop_memb TEXT,
    p_ind_ativ_com_mov_soc_memb TEXT,
    p_ind_ativ_com_nao_sabe_memb TEXT,
    p_ind_ativ_com_nao_resp_memb TEXT,
    p_ind_atend_cras_memb TEXT,
    p_ind_atend_creas_memb TEXT,
    p_ind_atend_centro_ref_rua_memb TEXT,
    p_ind_atend_inst_gov_memb TEXT,
    p_ind_atend_inst_nao_gov_memb TEXT,
    p_ind_atend_hospital_geral_memb TEXT,
    p_cod_cart_assinada_memb TEXT,
    p_ind_dinh_const_memb TEXT,
    p_ind_dinh_flanelhinha_memb TEXT,
    p_ind_dinh_carregador_memb TEXT,
    p_ind_dinh_catador_memb TEXT,
    p_ind_dinh_servs_gerais_memb TEXT,
    p_ind_dinh_pede_memb TEXT,
    p_ind_dinh_vendas_memb TEXT,
    p_ind_dinh_outro_memb TEXT,
    p_ind_dinh_nao_resp_memb TEXT,
    p_ind_atend_nenhum_memb TEXT,
    p_ref_cad TEXT,
    p_ref_pbf TEXT
);

-- Cria índices para melhorar performance em consultas comuns
CREATE INDEX idx_cadu_raw_cod_familiar_fam ON cadu_raw(d_cod_familiar_fam);
CREATE INDEX idx_cadu_raw_cpf ON cadu_raw(p_num_cpf_pessoa);
CREATE INDEX idx_cadu_raw_nis ON cadu_raw(p_num_nis_pessoa_atual);
CREATE INDEX idx_cadu_raw_created_at ON cadu_raw(created_at);

-- Comentário na tabela
COMMENT ON TABLE cadu_raw IS 'Tabela raw para armazenar dados do Cadastro Único (CADU) importados via CSV';
